{#- Template for GraphQL operations.

This template renders a GraphQL mutation, query, or subscription.

Context:
    operation (OperationTypeDefinition): The operation to render.
    root (bool): Whether this is the root object, injected with `:::` in a
        Markdown page.
    heading_level (int): The HTML heading level to use.
    config (dict): The configuration options.
-#}

{% block logs scoped %}
    {#- Logging block -#}
    {{ log.debug("Rendering " + operation.path) }}
{% endblock logs %}

<div class="doc doc-object doc-operation">
    {% with obj = operation, html_id = operation.path %}
        {% if root %}
            {% set show_full_path = config.show_root_full_path %}
            {% set root_members = True %}
        {% elif root_members %}
            {% set show_full_path = config.show_root_members_full_path or config.show_node_full_path %}
            {% set root_members = False %}
        {% else %}
            {% set show_full_path = config.show_node_full_path %}
        {% endif %}

        {% set operation_name = operation.path if show_full_path else operation.name %}
        {% set symbol_type = operation.kind %}

        {% if not root or config.show_root_heading %}
            {% filter heading(
                heading_level,
                role="operation",
                id=html_id,
                class="doc doc-heading",
                toc_label=('<code class=doc-symbol doc-symbol-toc doc-symbol-' + symbol_type + '"></code>&nbsp;'|safe if config.show_symbol_type_toc else '') + operation.name,
            ) %}
                {% block heading scoped %}
                    {#- Heading block.

                    Renders the heading for the operation.
                    -#}
                    {% if config.show_symbol_type_heading %}<code class="doc-symbol doc-symbol-heading doc-symbol-{{ symbol_type }}"></code>{% endif %}
                    <span class="doc doc-object-name doc-operation-name">{{ config.heading if config.heading and root else operation_name }}</span>
                {% endblock heading %}
            {% endfilter %}

            {% block signature scoped %}
                {#- Signature block.

                Renders the signature for the operation.
                -#}
                {% filter format_signature(operation) %}
                    {{ operation.name }}
                {% endfilter %}
            {% endblock signature %}

        {% else %}

            {% if config.show_root_toc_entry %}
                {% filter heading(
                    heading_level,
                    role="operation",
                    id=html_id,
                    toc_label=('<code class="doc-symbol doc-symbol-toc doc-symbol-' + symbol_type + '"></code>&nbsp;'|safe if config.show_symbol_type_toc else '') + (config.toc_label if config.toc_label and root else operation.name),
                    hidden=True,
                ) %}
                {% endfilter %}
            {% endif %}
            {% set heading_level = heading_level - 1 %}
        {% endif %}

        <div class="doc doc-contents {% if root %}first{% endif %}">
            {% block contents scoped %}
                {#- Contents block.

                Renders the contents of the operation. It contains other blocks
                that the user can override. Overriding the contents block allows
                to rearrange the order of the blocks.
                -#}
                {% block docstring scoped %}
                    {#- Docstring block. -#}
                    {% with docstring_sections = operation.docstring %}
                        {% include "docstring.html.jinja" %}
                    {% endwith %}
                {% endblock docstring %}
            {% endblock contents %}
        </div>

    {% endwith %}
</div>
